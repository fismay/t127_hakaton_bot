<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>t127_hakaton_bot - MiniApp</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div id="app-root"></div>
  <div style="padding:20px;">
    <h1>Productivity Tree - Demo</h1>
    <div id="msg"></div>
    <div>
      <button id="btn-create-profile">Create sample profile</button>
      <button id="btn-add-task">Add sample task</button>
      <button id="btn-finish-task">Finish task #1</button>
      <button id="btn-get-profile">Get profile</button>
      <button id="btn-get-tasks">Get tasks</button>
    </div>
    <pre id="out" style="background:#f3f4f6;padding:10px;margin-top:10px;"></pre>
  </div>
  <script src="/app.js"></script>
  <script>
    document.getElementById('btn-create-profile').onclick = async ()=>{
      const res = await fetch('/api/profile', {method:'POST', headers:{'content-type':'application/json'}, body:JSON.stringify({name:'Иван', role:'Студент'})});
      const j = await res.json(); document.getElementById('out').textContent = JSON.stringify(j, null, 2);
    };
    document.getElementById('btn-add-task').onclick = async ()=>{
      const tomorrow = Math.floor((Date.now()+24*3600*1000)/1000);
      const res = await fetch('/api/tasks', {method:'POST', headers:{'content-type':'application/json'}, body:JSON.stringify({title:'Сделать домашку', note:'по математике', due:tomorrow})});
      const j = await res.json(); document.getElementById('out').textContent = JSON.stringify(j, null, 2);
    };
    document.getElementById('btn-finish-task').onclick = async ()=>{
      const res = await fetch('/api/tasks/1/finish', {method:'POST'}); const j=await res.json(); document.getElementById('out').textContent = JSON.stringify(j,null,2);
    };
    document.getElementById('btn-get-profile').onclick = async ()=>{ const res=await fetch('/api/profile'); document.getElementById('out').textContent = JSON.stringify(await res.json(),null,2); };
    document.getElementById('btn-get-tasks').onclick = async ()=>{ const res=await fetch('/api/tasks'); document.getElementById('out').textContent = JSON.stringify(await res.json(),null,2); };
  </script>
</body>
</html>
